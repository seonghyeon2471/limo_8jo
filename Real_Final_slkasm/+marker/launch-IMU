<launch>

  <!-- 1) 기존 SLAM + LKAS + 마커 전체 launch 포함 -->
  <include file="$(find Real_Final_slkasm)/+marker/launch/limo_total.launch"/>

  <!-- 2) cmd_vel → cmd_vel_raw 로 릴레이 (IMU 스크립트가 받도록) -->
  <node pkg="topic_tools" type="relay" name="relay_cmd_vel" output="screen">
    <param name="input" value="/cmd_vel"/>
    <param name="output" value="/cmd_vel_raw"/>
  </node>

  <!-- 3) IMU 기반 속도 필터링 -->
  <node pkg="Real_Final_slkasm"
        type="imu_soft_controller.py"
        name="imu_soft_controller"
        output="screen">

    <param name="cmd_in_topic"  value="/cmd_vel_raw"/>
    <param name="cmd_out_topic" value="/cmd_vel"/>
    <param name="imu_topic"     value="/imu/data"/>

    <param name="max_accel" value="0.4"/>
    <param name="max_decel" value="0.6"/>

    <param name="gyro_y_thresh" value="1.5"/>
    <param name="bump_speed" value="0.08"/>
    <param name="bump_hold" value="2.0"/>
    <param name="bump_min_interval" value="1.0"/>
    <param name="cmd_timeout" value="0.5"/>
  </node>

</launch>
